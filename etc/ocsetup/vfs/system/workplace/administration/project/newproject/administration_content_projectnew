<?xml version="1.0"?>
<WORKPLACE>
<TEMPLATE>
<![CDATA[
<HTML>

<!-- Include external JavaScripts-->
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="]]><PROCESS>pathCorrection</PROCESS><![CDATA[../templates/js/opencms.js"></SCRIPT>

<script language=JavaScript>
<!--

if(top.frames[0].document.projectchange.project.options[top.frames[0].document.projectchange.project.selectedIndex].value !=]]><PROCESS>onlineId</PROCESS><![CDATA[){
    window.top.head.location.href='../../../action/head.html';
}

top.help_url='Administration/projektverwaltung/Projekterstellen.html';

function deleteAnItem(theList,itemNo) {
var n=theList.length;
if ((n > 0) && (itemNo > -1)) {
    theList.options[itemNo]=null; 
}
}

function addFolder(theList, item) { 
    if (item != null && item != "") {
        newOption = new Option(item, item, false, false); 
        theList.options[theList.length] = newOption;
        document.PROJECTNEW.selectallfolders.value='';
    }
}

function addChannel(theList, item) {
    if (item != null && item != "") {
        newOption = new Option(item, item, false, false); 
        theList.options[theList.length] = newOption;
    }
}

function copySelection() { 
    addFolder(document.PROJECTNEW.new_ressources, document.PROJECTNEW.tempFolder.value);
}

function copyChannelSelection() {
    addChannel(document.PROJECTNEW.new_channels, document.PROJECTNEW.tempChannel.value);
}

function selectAll(theFolders, theChannels) {
    var n=theFolders.length;
    for (i=0; i<n; i++) {
        theFolders.options[i].selected=true;
    }
    // umgehe das Problem mit Silverstream
    var allResources="";
    if (n>0) {
        for (i=0; i<n; i++) {
            allResources = allResources + theFolders.options[i].value + ';';
        } 
    } 
    document.PROJECTNEW.ALLRES.value=allResources;
    // now the channels
    var m=theChannels.length;
    for (i=0; i<m; i++) {
        theChannels.options[i].selected=true;
    }
    // umgehe das Problem mit Silverstream
    var allChannels="";
    if (m>0) {
        for (i=0; i<m; i++) {
            allChannels = allChannels + theChannels.options[i].value + ';';
        } 
    } 
    document.PROJECTNEW.ALLCHAN.value=allChannels;    
}

var lasturl=']]><PROCESS>backButton</PROCESS><![CDATA[';

//-->
</script>

<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">

<title>OpenCms</title>
<link rel=stylesheet type="text/css" href="]]><PROCESS>pathCorrection</PROCESS><![CDATA[../css/format.css">

</HEAD>
<BODY bgcolor="#ffffff" marginwidth = 0 marginheight = 0 topmargin=0 leftmargin=0 onLoad="]]><PROCESS>doThis</PROCESS><PROCESS>dontDoIt</PROCESS><![CDATA[window.top.body.admin_head.location.href='../../../action/administration_head.html';" onUnload="if(treewin!=null)treewin.close();">

<!-- Tabelle um vertikal und horizontal zu zentrieren-->
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td align=middle valign=center>

<!-- Tabellenaufbau für Dialog mit OK und Abbrechen-->
<form id="PROJECTNEW" name="PROJECTNEW">
<input type=hidden name="submitform" value="true">
<table cellspacing=0 cellpadding=0 border=1 width=500>
    <tr><td>
        <table cellspacing=0 cellpadding=5 border=0 width=100% height=100%>
            
            <!-- Beginn Tabellenkopf blau-->
            <tr> 
        <td class="head">]]><LABEL value="label.createnewproject" /><![CDATA[</td>
            </tr>
            <!-- Ende Tabellenkopf blau-->
            
            <!-- Beginn Leerzeile-->
            <tr> 
        <td class="leerzeile">&nbsp;</td>
            </tr>
            <!-- Ende Leerzeile-->
            
            <!-- Beginn Inhalt-->
            <tr><td class=dialogtxt>
                <table border=0 width=100%>
                    <tr><td class=dialogtxt>
                        <table border=0 cellspacing=4 width=100% height=200px>
                            <tr>
                                <td class=formular width=10%>]]><LABEL value="label.projectname" /><![CDATA[:</td>
                                <td class=dialogtxt><input type="text" name="NAME" class="textfeld3" size=31 maxlength=16 value="]]><PROCESS>new_project_name</PROCESS><![CDATA["> </td>
                                <td class=formular><img src="]]><METHOD name="picsUrl">empty.gif</METHOD><![CDATA[" width="50" height="1" alt="" border="0"></td>
                            </tr>
                            <tr>
                                <td class=formular valign=top>]]><LABEL value="label.description" /><![CDATA[:</td>
                                <td class=dialogtxt valign=top>
                                    <TEXTAREA class="textarea" id=DESCRIPTION name=DESCRIPTION rows=5 cols=30>]]><PROCESS>new_project_description</PROCESS><![CDATA[</TEXTAREA>
                                </td>
                                <td class=formular>&nbsp;</td>
                            </tr>
                            <tr>
                                <td class=formular>&nbsp;</td>
                                <td class=dialogtxt> 
                                <input type="text" name="selectallfolders" class="textfeld3" size=31 value=""
                                     onSubmit="">   

                                </td> 
                                <td class=formular valign=bottom> 
                                    <a href="javascript:addFolder(document.PROJECTNEW.new_ressources, document.PROJECTNEW.selectallfolders.value);" ><img src="]]><METHOD name="picsUrl">ic_admin_enter.gif</METHOD><![CDATA[" alt="]]><LABEL value="button.addnew" /><![CDATA[" border=0 width=16 heigth=16></a> 
                                </td>                                
                            </tr>
                            <tr> 
                                <td class=formular valign=top>]]><LABEL value="label.allfolders" /><![CDATA[:</td>
                                <td class=dialogtxt>
                                    <select name="new_ressources" id="new_ressources" style="width:300px" size=5 width="300" multiple></select>
                                </td>
                                <td valign=middle>
                                    <table border=0 cellspacing=0 width=100% height=100% valign=middle> 
                                        <tr>
                                            <td class=formular><a href="javascript:treewin=opensmallwin(']]><PROCESS>pathCorrection</PROCESS><![CDATA[../action/folder_tree.html?foldertree=/&formname=PROJECTNEW&variable=tempFolder&onlineselect=yes&viewfile=no', 'explorer_viewer', 150, 300),treewin.focus();"><img src="]]><METHOD name="picsUrl">ic_file_folder.gif</METHOD><![CDATA[" border="0" alt="]]><LABEL value="label.selectfolder" /><![CDATA["></a></td>
                                            <td class=formular><a href="javascript:deleteAnItem(document.PROJECTNEW.new_ressources , document.PROJECTNEW.new_ressources.selectedIndex);"><img src="]]><METHOD name="picsUrl">ic_admin_deleteext.gif</METHOD><![CDATA[" alt="]]><LABEL value="button.delete" /><![CDATA[" border=0 width=16 heigth=16></a></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <input type="hidden" name="tempFolder" id="tempFolder" > 
                            <input type="hidden" name="ALLRES" id="ALLRES" value="">
                            <tr> 
                                <td class=formular valign=top>]]><LABEL value="label.allchannels" /><![CDATA[:</td>
                                <td class=dialogtxt>
                                    <select name="new_channels" id="new_channels" style="width:300px" size=5 width="300" multiple></select>
                                </td>
                                <td valign=middle>
                                    <table border=0 cellspacing=0 width=100% height=100% valign=middle> 
                                        <tr>
                                            <td class=formular><a href="javascript:treewin=opensmallwin(']]><PROCESS>pathCorrection</PROCESS><![CDATA[../action/channel_tree.html?foldertree=/&formname=PROJECTNEW&variable=tempChannel&onlineselect=yes&viewfile=no', 'explorer_viewer', 150, 300),treewin.focus();"><img src="]]><METHOD name="picsUrl">ic_file_folder.gif</METHOD><![CDATA[" border="0" alt="]]><LABEL value="label.selectfolder" /><![CDATA["></a></td>
                                            <td class=formular><a href="javascript:deleteAnItem(document.PROJECTNEW.new_channels , document.PROJECTNEW.new_channels.selectedIndex);"><img src="]]><METHOD name="picsUrl">ic_admin_deleteext.gif</METHOD><![CDATA[" alt="]]><LABEL value="button.delete" /><![CDATA[" border=0 width=16 heigth=16></a></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <input type="hidden" name="tempChannel" id="tempChannel" > 
                            <input type="hidden" name="ALLCHAN" id="ALLCHAN" value="">
                            <tr>
                                <td colspan=3 class=leerzeile>&nbsp;</td>
                            </tr>
                            <tr>
                                <td class=formular width=10%>]]><LABEL value="label.groupsprojectworker" /><![CDATA[:</td>
                                <td class=dialogtxt>
                                    ]]><SELECT class="textfeld" name="GROUP" width="150" method="getGroups" onchange=""/><![CDATA[
                                </td>
                                <td class=formular>&nbsp;</td>
                            </tr>
                            <tr>
                                <td class=formular valign=top>]]><LABEL value="label.groupsprojectmanager" /><![CDATA[:</td>
                                <td class=dialogtxt valign=top>
                                    ]]><SELECT class="textfeld" name="MANAGERGROUP" width="150" method="getManagerGroups" onchange=""/><![CDATA[
                                </td>
                                <td class=formular>&nbsp;</td>
                            </tr>
                            <tr> 
                                <td class=formular width=10%>&nbsp;</td>
                                <td class=formular>
                                <input type=checkbox name="projecttype" value="projecttype">]]><LABEL value="label.projecttype"/><![CDATA[
                                </td>
                                <td class=formular>&nbsp;</td>
                            </tr>                        
                </table>
            </td></tr>
            
            <!-- Beginn Buttonleisete-->
            <tr><td class=dialogtxt>
                <table cellspacing=0 border=0 cellpadding=5 width=100%>
                <tr>
                    <td class=formular align=right width=50%>]]><SUBMITBUTTON class="button" name="ok" value="ok" width="100" action="selectAll(PROJECTNEW.new_ressources, PROJECTNEW.new_channels);" /><![CDATA[</td>
                    <td class=formular align=left width=50%>]]><TEXTBUTTON class="button" name="cancel" value="cancel" width="100" action="location.href=lasturl" /><![CDATA[</td>
                </tr>
                </table>
            </td>
            </tr>
            <!-- Ende Buttonleisete-->
            
            </table>
    </td></tr>
</table>
</td></tr>
</table>
</form>
</td></tr>
</table>

</BODY>
</html>
]]>
</TEMPLATE>

<TEMPLATE name="errornewproject">
<![CDATA[
]]><ERRORPAGE title="error.title.newproject" message="error.message.newproject" reason="error.reason.newproject" suggestion="error.suggestion.newproject" ref="index.html?sender=/system/workplace/administration/project/newproject/index.html"><process>details</process></ERRORPAGE><![CDATA[
]]>
</TEMPLATE>

<TEMPLATE name="datamissing">
<ERRORPAGE title="error.title.newproject" message="error.message.projectdatamissing" reason="error.reason.projectdatamissing" suggestion="error.suggestion.none" ref="index.html?sender=/system/workplace/administration/project/newproject/index.html"></ERRORPAGE>
</TEMPLATE>

<TEMPLATE name="errornewprojectexplorer">
<ERRORPAGE title="error.title.newproject" message="error.message.newproject" reason="error.reason.newproject" suggestion="error.suggestion.newproject" ref="resource_to_project.html?sender=/system/workplace/administration/project/newproject/index.html"><process>details</process></ERRORPAGE>
</TEMPLATE>

<TEMPLATE name="datamissingexplorer">
<ERRORPAGE title="error.title.newproject" message="error.message.projectdatamissing" reason="error.reason.projectdatamissing" suggestion="error.suggestion.none" ref="resource_to_project.html?sender=/system/workplace/administration/project/newproject/index.html"></ERRORPAGE>
</TEMPLATE>

<TEMPLATE name="wait">
<![CDATA[
<HTML>
<HEAD>
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="]]><PROCESS>pathCorrection</PROCESS><![CDATA[../templates/js/opencms.js"></SCRIPT>

<SCRIPT LANGUAGE="Javascript">
function reload(){
    location.href="]]><PROCESS>myUrl</PROCESS><![CDATA[?action=working&time=]]><PROCESS>time</PROCESS><![CDATA[" ;
}
</SCRIPT>

</HEAD>
<BODY onload="setTimeout('reload()', 1000);">
<CENTER>
<!-- Begin Logo opencms -->
<table border=0 cellspacing=0 cellpadding=0 align=center height=100>
    <tr>
        <td><IMG alt=OpenCms border=0 hspace=0 src="]]><METHOD name="picsUrl">opencms.gif</METHOD><![CDATA["></td>
    </tr>
</table>
<!-- End Logo opencms -->

<!-- Begin please wait text -->
<table cellspacing=0 cellpadding=0 border=0>
<tr>
<td><font size="-1" face="MS Sans Serif,Arial,Helvetica">]]><LABEL value="message.wait"/><![CDATA[</font></td>
</tr>
</table>
<!-- End please wait text -->
</CENTER>
</BODY>
</HTML>
]]>
</TEMPLATE>

<TEMPLATE name="done">
    <![CDATA[
    <HTML>
    <BODY onload="window.top.head.location.href=']]><PROCESS>pathCorrection</PROCESS><![CDATA[../action/head.html'; ]]><PROCESS>dontDoIt</PROCESS><![CDATA[parent.frames[1].location.href='../../../action/administration_content_top.html?sender=/system/workplace/administration/project/'">
    </BODY>
    </html>
    ]]>
</TEMPLATE>

<TEMPLATE name="norigths">
    <![CDATA[
    <HTML>
    <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
    <title>OpenCms</title>
    <link rel=stylesheet type="text/css" href="../css/format.css">
    </head>
    <BODY bgcolor="#ffffff" marginwidth = 0 marginheight = 0 topmargin=0 leftmargin=0>
    <table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
    <tr><td align=center valign=middle>
    <form id=cancel name=cancel>
    <table cellspacing=0 cellpadding=0 border=2 width=310px>
        <tr><td>
            <table cellspacing=0 cellpadding=5 border=0 width=100% height=100%>
                <!-- Begin tablehead blue -->
                <tr> 
                    <td colspan=3 class="head">]]><LABEL value="explorer.context.project" /><![CDATA[</td>
                </tr>
                <!-- Ende tablehead blue -->
                <tr> 
                    <td colspan=3 class="leerzeile">&nbsp;</td>
                </tr>
                <tr> 
                    <td colspan=3 class="leerzeile">&nbsp;</td>
                </tr>
                <tr>
                    <td class=dialogtxt colspan=3>
                        ]]><LABEL value="error.message.createasproject"/><![CDATA[<br>
                    </td>
                </tr>
                <tr> 
                    <td colspan=3 class="leerzeile">&nbsp;</td>
                </tr>
                <!-- Begin buttons -->
                <tr><td class=dialogtxt colspan=3>
                    <table cellspacing=0 cellpadding=5 width=100%>
                    <tr>
                        <td class=formular align=right width=50%><INPUT class=button width=100 type="button" value="]]><LABEL value="button.ok" /><![CDATA[" id=OK name=OK onClick="location.href='explorer_files.html';"></td>
                    </tr>
                    </table>
                </td>
                </tr>
                <!-- End buttons -->
                </table>
        </td></tr>
    </table>
    </form>
    </td></tr>
    </table>
    </BODY>
    </html> ]]>
</TEMPLATE>

</WORKPLACE>