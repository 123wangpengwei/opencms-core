<?xml version="1.0"?>
<WORKPLACE>
<nounchanged></nounchanged>
<nounchangedbox><![CDATA[
							<tr> 
								<td>&nbsp;</td>
								<td class=formular>
									<input type=checkbox name="nounchanged" value="nounchanged" checked>]]><LABEL value="database.label.nounchanged"/><![CDATA[
								</td>
							</tr>
]]></nounchangedbox>

<TEMPLATE>
<![CDATA[

<HTML>

<script language=JavaScript>
<!--
function show_help()
{
	return '5_2_5_1.html';
}
//-->
</script>

<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">

<title>OpenCms</title>
<link rel=stylesheet type="text/css" href="../../../css/format.css">
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="../../../templates/js/opencms.js"></SCRIPT> 

<script language=JavaScript>
<!--
//------------------------------------------------------------------------------------
// checkFormData(formField) 
// 
// author:	Matthias Schreiber
// company:	mindfact interaktive medien ag
// date:	13.03.2000
// update:	14.03.2000
//
// Method checkFormData performs a client-side check of form fields containing names.
// Form can be surrounded by <DIV>-section (layer).
// 
// @param form Name of the form where the field to be checked is situated
// @param field Name of the field to be checked
// @param lyr Name of the layer in which the form is embedded. If there's no layer set it to null.
// 
//------------------------------------------------------------------------------------

function checkFormData()
{
	var result=true;
	var at_pos, entry, strLength;
	
	entry = document.DBEXPORT.VNAME.value;
	strLength=entry.length;
	
	for (i=0; i < strLength; i++) 
	{
		if (charList.indexOf(entry.charAt(i))==-1)
		{	
			alert(']]><LABEL value="error.message.badcharacter" /><![CDATA[' + entry.charAt(i));
			document.DBEXPORT.VNAME.focus;
			return false;
		}
	}
	return result;
}		

function deleteAnItem(theList,itemNo) {
   var n=theList.length;
   if ((n > 0) && (itemNo > -1)) {
	   for (i=itemNo; i<n-1; i++) {
		  theList.options[i]=theList.options[i+1];
	   }
	   theList.options[n-1]=null; 
   }
}

function addFolder(theList, item) {  
	if (item != null && item != "") {
		newOption = new Option(item, item, false, false); 
		theList.options[theList.length] = newOption;
	}
}

function copySelection() { 
	addFolder(document.DBEXPORT.new_ressources, document.DBEXPORT.tempFolder.value);
}

function selectAll(theList) {
	var n=theList.length;
	for (i=0; i<n; i++) {
		theList.options[i].selected=true;
	}
	// umgehe das Problem mit Silverstream
	var allResources="";
	if (n>0) {
		for (i=0; i<n; i++) {
			allResources = allResources + theList.options[i].value + ';';
		} 
	} 
	document.DBEXPORT.ALLRES.value=allResources;
}

//-->
</script>

</HEAD>
<BODY bgcolor="#ffffff" background="]]><METHOD name="picsUrl">bg_weiss.gif</METHOD><![CDATA["  bgproperties=fixed marginwidth = 0 marginheight = 0 topmargin=0 leftmargin=0 onLoad="window.top.body.admin_head.location.href='../../../action/administration_head.html';" onUnload="if(treewin!=null)treewin.close();">

<!-- Tabelle um vertikal und horizontal zu zentrieren-->
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td align=middle valign=center>

<!-- Tabellenaufbau für Dialog mit OK und Abbrechen-->
<form id=DBEXPORT name=DBEXPORT action="index.html?action=export" method="post" onSubmit="return checkFormData()">
<table cellspacing=0 cellpadding=0 border=2 width=450>
	<tr><td>
		<table cellspacing=0 cellpadding=5 border=0 width=100% height=100%>
			
			<!-- Beginn Tabellenkopf blau-->
			<tr> 
           		<td class="head">]]><LABEL value="database.label.titleexport"/><![CDATA[</td>
			</tr>
			<!-- Ende Tabellenkopf blau-->
			
			<!-- Beginn Leerzeile-->
			<tr> 
           		<td class="leerzeile">&nbsp;</td>
			</tr>
			<!-- Ende Leerzeile-->
			
			<!-- Beginn Inhalt-->
			<tr><td class=dialogtxt>
				<table border=1 width=100%>
					<tr><td class=dialogtxt>
						<table border=0 width=100%>
							<tr>
								<td class=formular>]]><LABEL value="input.exportadd" /><![CDATA[:</td>
								<td class=dialogtxt> 
								<input type="text" name="selectallfolders" class="textfeld3" size=31 value=""
									   onSubmit="">	

								</td> 
								<td class=formular valign=bottom> 
									<a href="javascript:addFolder(document.DBEXPORT.new_ressources, document.DBEXPORT.selectallfolders.value);" ><img src="]]><METHOD name="picsUrl">ic_admin_enter.gif</METHOD><![CDATA[" alt="]]><LABEL value="button.addnew" /><![CDATA[" border=0 width=16 heigth=16></a> 
								</td>								 
							</tr>
							<tr> 
								<td class=formular valign=middle>]]><LABEL value="input.exportresources" /><![CDATA[:</td>
								<td class=dialogtxt>
									<select name="new_ressources" id="new_ressources" style="width:300px" size=5 width="300" multiple></select>
								</td>
								<td valign=middle>
									<table border=0 cellspacing=0 width=100% height=100% valign=middle> 
										<tr>
											<td class=formular><a href="javascript:treewin=opensmallwin('../../../action/folder_tree.html?foldertree=/&formname=DBEXPORT&variable=tempFolder&viewfile=yes', 'explorer_viewer', 150, 300),treewin.focus();"><img src="]]><METHOD name="picsUrl">ic_file_folder.gif</METHOD><![CDATA[" border="0" alt="]]><LABEL value="label.selectfolder" /><![CDATA["></a></td>
											<td class=formular><a href="javascript:deleteAnItem(document.DBEXPORT.new_ressources , document.DBEXPORT.new_ressources.selectedIndex);"><img src="]]><METHOD name="picsUrl">ic_admin_deleteext.gif</METHOD><![CDATA[" alt="]]><LABEL value="button.delete" /><![CDATA[" border=0 width=16 heigth=16></a></td>
										</tr>
									</table>
								</td>
							</tr>
							<tr> 
								<td>&nbsp;</td>
								<td class=formular>
									<input type=checkbox name="nosystem" value="nosystem" checked>]]><LABEL value="database.label.nosystem"/><![CDATA[
									<input type="hidden" name="tempFolder" id="tempFolder"> 
									<input type="hidden" name="ALLRES" id="ALLRES" value="">
								</td>
							</tr>
							]]><PROCESS>nounchanged</PROCESS><![CDATA[
							<tr>
								<td class=formular width=10%>]]><LABEL value="database.label.filename"/><![CDATA[:</td>
								<td class=dialogtxt><input type="text" class="textfeld3" maxlength="30" name="filename" id="VNAME"></td> 
							</tr>
							<tr>
								<td class=formular>]]><LABEL value="database.label.files"/><![CDATA[:</td>
								<td class=dialogtxt>
									]]><SELECT class="textfeld" name="existingfile" width="300" method="getExportFiles" onchange="document.DBEXPORT.filename.value=document.DBEXPORT.existingfile.options[document.DBEXPORT.existingfile.selectedIndex].value;"/><![CDATA[
								</td>
							</tr>
							<!-- Beginn Leerzeile-->
							<tr> 
           						<td class="leerzeile" colspan=3>&nbsp;</td>
							</tr>
							<!-- Ende Leerzeile-->
							</table>
					</td></tr>
				</table>
			</td></tr>
			
			<!-- Beginn Buttonleisete-->
			<tr><td class=dialogtxt>
				<table cellspacing=0 cellpadding=5 width=100%>
				<tr>
					<td class=formular align=right width=50%>]]><SUBMITBUTTON class="button" name="ok" value="ok" width="100" action="selectAll(DBEXPORT.new_ressources);" /><![CDATA[</td>
					<td class=formular align=left width=50%>]]><TEXTBUTTON class="button" name="cancel" value="cancel" width="100" action="location.href='../../../action/administration_content_top.html?sender=/system/workplace/administration/database/'" /><![CDATA[</td>
				</tr>
				</table>
			</td>
			</tr>
			<!-- Ende Buttonleisete-->
			
			</table>
	</td></tr>
</table>
</form>
</td></tr>
</table>

</BODY>
</html>

]]>
</TEMPLATE>

<TEMPLATE name="error">
<![CDATA[
]]><ERRORPAGE title="error.title.database" message="error.message.database" reason="error.reason.database" suggestion="error.suggestion.database" ref="index.html?sender=/system/workplace/administration/database/export/index.html" ><process>details</process></ERRORPAGE><![CDATA[
]]>
</TEMPLATE>

<TEMPLATE name="wait">
<![CDATA[
<HTML>
<HEAD>
<meta http-equiv="refresh" content="15; URL=index.html?action=working&time=]]><PROCESS>time</PROCESS><![CDATA[">
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="../../../templates/js/opencms.js"></SCRIPT>
</HEAD>
<BODY onload="">
<CENTER>
<!-- Begin Logo opencms -->
<table border=0 cellspacing=0 cellpadding=0 align=center height=100>
	<tr>
		<td><IMG alt=OpenCMS border=0 hspace=0 src="]]><METHOD name="picsUrl">opencms.gif</METHOD><![CDATA["></td>
	</tr>
</table>
<!-- End Logo opencms -->

<!-- Begin please wait text -->
<table cellspacing=0 cellpadding=0 border=0>
<tr>
<td><font size="-1" face="MS Sans Serif,Arial,Helvetica">]]><LABEL value="message.wait"/><![CDATA[</font></td>
</tr>
</table>
<!-- End please wait text -->
<table cellspacing=0 cellpadding=0 border=0>
	<tr><br><br>
		<td><IMG width=]]><PROCESS>time</PROCESS><![CDATA[ height=20 border=0 hspace=0 src="]]><METHOD name="picsUrl">pixel_blue.gif</METHOD><![CDATA["></td>
	</tr>
</table>
</CENTER>
</BODY>
</HTML>
]]>
</TEMPLATE>


<TEMPLATE name="done">
<![CDATA[
<HTML>
<HEAD>
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="../../../templates/js/opencms.js"></SCRIPT>
</HEAD>
<BODY onload="parent.admin_content.location.href='../../../action/administration_content_top.html?sender=/system/workplace/administration/database/';">
<CENTER>
<!-- Begin Logo opencms -->
<table border=0 cellspacing=0 cellpadding=0 align=center height=100>
	<tr>
		<td><IMG alt=OpenCMS border=0 hspace=0 src="]]><METHOD name="picsUrl">opencms.gif</METHOD><![CDATA["></td>
	</tr>
</table>
<!-- End Logo opencms -->

<!-- Begin please wait text -->
<table cellspacing=0 cellpadding=0 border=0>
<tr>
<td><font size="-1" face="MS Sans Serif,Arial,Helvetica">]]><LABEL value="message.wait"/><![CDATA[</font></td>
</tr>
</table>
<!-- End please wait text -->
</CENTER>
</BODY>
</HTML>
]]>
</TEMPLATE>

</WORKPLACE>