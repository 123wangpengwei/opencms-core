<?xml version="1.0" encoding="ISO-8859-1"?>
<workplace>
<template>
<![CDATA[
<html>

<head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=]]><METHOD name="getEncoding"/><![CDATA[">

<title>]]><LABEL value="label.wptitle" /><![CDATA[ ]]><METHOD name="userName" /><![CDATA[</title>
<link rel=stylesheet type="text/css" href="]]><method name="resourcesUri">format.css</method><![CDATA[">
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="]]><method name="scriptsUri">opencms.js</method><![CDATA["></SCRIPT>
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript">

	]]><ELEMENT name="edit_options"/><![CDATA[

	// which button is clicked
	function doTemplSubmit(para)
	{
		document.EDITOR.action.value = "";
		switch (para)
		{
		case 1:
			doSubmit();
			document.EDITOR.submit();
			break;
		case 2:
			alert("NYI!");
			break;
		case 3:
			doSubmit();
			document.EDITOR.submit();
			break;
		case 4:
			// new template selected
			doSubmit();
			document.EDITOR.submit();
			break;
		case 5:
			// preview selected
			doSubmit();
			document.PREVIEW.bodyclass.value = document.EDITOR.bodyclass.value;
			document.PREVIEW.bodyfile.value = document.EDITOR.bodyfile.value;
			document.PREVIEW.title.value = document.EDITOR.title.value;
			document.PREVIEW.body.value = document.EDITOR.body.options[document.EDITOR.body.selectedIndex].value;
			document.PREVIEW.bodytitle.value = document.EDITOR.bodytitle.value;
			document.PREVIEW.template.value = document.EDITOR.template.options[document.EDITOR.template.selectedIndex].value;
			document.PREVIEW.editor.value = document.EDITOR.editor.options[document.EDITOR.editor.selectedIndex].value;
			document.PREVIEW.content.value = document.EDITOR.content.value;
			document.PREVIEW.file.value = document.EDITOR.file.value;
			document.PREVIEW.action.value = "preview";
			document.PREVIEW.submit();
			break;
		case 6:
			// New Body;
			doSubmit();
			document.EDITOR.action.value = "newbody";
			document.EDITOR.submit();
			break;
		}
	}

	<!-- Sets the Document Source-Code for later including into the editor -->
	var text="]]><METHOD name="setText"/><![CDATA[";

	<!-- URL for pictures -->
	var pfad="]]><METHOD name="resourcesUri"/><![CDATA[";

	<!-- Filename -->
	var filename="]]><PROCESS>file</PROCESS><![CDATA[";

	<!-- Needed space for additional toolbar -->
	var space=75;

	var tbsize = 73;
	
	var NS = null;
	var IE = null;

	NS = (document.layers)? true:false;
	IE = (document.all)? true:false;

	var LANG_CUT = "]]><LABEL value="editor.context.cut"/><![CDATA[";
	var LANG_COPY = "]]><LABEL value="editor.context.copy"/><![CDATA[";
	var LANG_PASTE = "]]><LABEL value="editor.context.paste"/><![CDATA[";
	var LANG_INSERTROW = "]]><LABEL value="editor.context.insertrow"/><![CDATA[";
	var LANG_DELETEROW = "]]><LABEL value="editor.context.deleterow"/><![CDATA[";
	var LANG_INSERTCOL = "]]><LABEL value="editor.context.insertcol"/><![CDATA[";
	var LANG_DELETECOL = "]]><LABEL value="editor.context.deletecol"/><![CDATA[";
	var LANG_INSERTCELL = "]]><LABEL value="editor.context.insertcell"/><![CDATA[";
	var LANG_DELETECELL = "]]><LABEL value="editor.context.deletecell"/><![CDATA[";
	var LANG_MERGECELL = "]]><LABEL value="editor.context.mergecell"/><![CDATA[";
	var LANG_SPLITCELL = "]]><LABEL value="editor.context.splitcell"/><![CDATA[";
</SCRIPT>

<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="]]><method name="scriptsUri" /><![CDATA[opencms_]]><PROCESS>editor</PROCESS><![CDATA[.js"></SCRIPT>

<!-- Update the Font display on change -->
<SCRIPT LANGUAGE="javascript" FOR="EDIT_HTML" EVENT="DisplayChanged">
<!--
	function displayChangedHandle()
	{
	if (IE==true) return DisplayChanged();
	}
	displayChangedHandle();
	//-->
</script>

<!-- Show a context menu if the right mousebutton is clicked -->
<script LANGUAGE="javascript" FOR="EDIT_HTML" EVENT="ShowContextMenu">
<!--
	function showContextMenuHandle()
	{
	if (IE==true) return ShowContextMenu();
	}
	showContextMenuHandle();
//-->
</script>

<!-- Invoke a context menu action -->
<script LANGUAGE="javascript" FOR="EDIT_HTML" EVENT="ContextMenuAction(itemIndex)">
<!--
	function contextMenuActionHandle()
	{
	if (IE==true) return ContextMenuAction(itemIndex);
	}
	contextMenuActionHandle();
//-->
</script>

<SCRIPT LANGUAGE="javascript" FOR="EDIT_HTML" EVENT="onkeyup">
<!--
/**
 * if the user selected a text or a image, that has a link and delete
 * then the link will be clean.
 * this function is for pasted text from word to mshtml editor,too.
 */
	function checkContentByKeyUp()
	{
	var cBackSpace  = 8;
	var cDelete		= 46;
	var cReturn		= 13;
		if (IE==true) 
		{			
			var keyPressed;	
			keyPressed = document.EDITOR.EDIT_HTML.DOM.parentWindow.event.keyCode;		
			if (keyPressed == cBackSpace || keyPressed == cDelete || keyPressed == cReturn)
			{
				deleteEmptyATags();
			}
		}
	}
	checkContentByKeyUp();
//-->
</script>

<script LANGUAGE="vbscript">
Sub getStyles()
	' Create the block fmt names holder
	Set fmt = CreateObject("DEGetBlockFmtNamesParam.DEGetBlockFmtNamesParam.1")

	' Get the localized strings for the DECMD_SETBLOCKFMT command
	EDITOR.EDIT_HTML.ExecCommand DECMD_GETBLOCKFMTNAMES, OLECMDEXECOPT_DONTPROMPTUSER, fmt

	' Put the localized strings into a (JavaScript) array
	i = 0
	For Each fmtName In fmt.Names
		setStyles i, fmtName
		i = i + 1
	Next
End Sub
</script>

<!-- Ask user whether he really wants to leave Texteditor without saving -->
<script LANGUAGE="javascript">
<!--
	function confirmExit()
	{
		if (confirm("]]><LABEL value="editor.message.exit" /><![CDATA[")) {
			doEdit(1);
		}
	}
	function confirmExit()
	{
		if (EDITOR.edit1.IsModified(2)) {
			if (confirm("]]><LABEL value="editor.message.exit" /><![CDATA[")) {
				doEdit(1);
			}
		} else {
				doEdit(1);
		}
	}
//-->
</script>

<!-- Ask user whether he really wants to leave HTML-Editor without saving -->
<script LANGUAGE="javascript">
<!--
	function confirmExitHTML()
	{
		
		if (EDITOR.EDIT_HTML.IsDirty) {
			if (confirm("]]><LABEL value="editor.message.exit" /><![CDATA[")) {
				doEditHTML(1);
			}
		} else {
				doEditHTML(1);
		}
	}
//-->
</script>

</head>

<body background="]]><METHOD name="resourcesUri">bg_grau2.gif</METHOD><![CDATA[" bgproperties=fixed scroll=no onLoad="setText();initStyles();" marginwidth=0 marginheight=0 leftmargin=0 topmargin=0>
<table cellspacing=0 cellpadding=0 border=0 width="100%" height="100%" class="toolbar">
<form name=EDITOR id=EDITOR METHOD=POST>
<INPUT TYPE=HIDDEN name="bodyclass" value="]]><PROCESS>bodyclass</PROCESS><![CDATA[">
<INPUT TYPE=HIDDEN name="bodyfile" value="]]><PROCESS>bodyfile</PROCESS><![CDATA[">
<INPUT TYPE=HIDDEN name="URL" id="URL">
	<tr>
		<td valign="top"><table width=100% cellspacing="0" cellpadding="0" border="0" class="toolbar">
			<tr height="28">
				<td width="5" align="left"><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="5" height="30"></td>
				<td align="left" width="20"><img src="]]><METHOD name="resourcesUri">bu_tb_start.gif</METHOD><![CDATA[" width="10" height="28"><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="10" height="28"></td>
				<td align="left"><table border="0" cellspacing="0" cellpadding="0">
					<tr height="20"> 
						<td>]]><LABEL value="input.title"/><![CDATA[:&nbsp;&nbsp;</td>
						<td>]]><INPUTFIELD name="title" class="textfeld" size="10" style="width:100px" length="255" method="setTitle"/><![CDATA[</td>
						<td><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="10" height="1"></td>
						<td>]]><LABEL value="input.editor"/><![CDATA[:&nbsp;&nbsp;</td>
						<td>]]><SELECT class="textfeld" name="editor" width="120" method="getEditorViews" onchange="doTemplSubmit(3);"/><![CDATA[</td>
						<td><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="10" height="1"></td>
						<script language="JavaScript">
						if (USE_TEMPLATESELECTOR && (! USE_BODYSELECTOR)) {
							document.write('<td>]]><LABEL value="input.template"/><![CDATA[:&nbsp;&nbsp;</td>');
							document.write('<td>]]><SELECT class="textfeld" name="template" width="150" method="getAvailableTemplates" onchange="doTemplSubmit(4);"/><![CDATA[</td>');
							document.write('<td><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="10" height="1"></td>');
						} else if (! USE_TEMPLATESELECTOR) {
							document.write('<td style="visibility:hidden;">]]><SELECT class="textfeld" name="template" width="1" method="getAvailableTemplates" /><![CDATA[</td>');
						}
						if (! USE_BODYSELECTOR) {
							document.write('<td style="visibility:hidden;">]]><SELECT class="textfeld" name="body" width="1" method="getBodys" /><![CDATA[</td>');
							document.write('<td><INPUT TYPE=HIDDEN name="bodytitle"></td>');
						}
						if (USE_TEMPLATESELECTOR && USE_BODYSELECTOR) {
							document.write('<td>]]><LABEL value="input.template"/><![CDATA[:&nbsp;&nbsp;</td>');
							document.write('<td>]]><SELECT class="textfeld" name="template" width="150" method="getAvailableTemplates" onchange="doTemplSubmit(4);"/><![CDATA[</td>');
							document.write('<td><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="10" height="1"></td>');
						}
						if (USE_BODYSELECTOR) {
							document.write('<td>]]><LABEL value="input.body"/><![CDATA[:&nbsp;&nbsp;</td>');
							document.write('<td>]]><SELECT class="textfeld" name="body" width="80" method="getBodys" onchange="doTemplSubmit(1);"/><![CDATA[</td>');
							document.write('<td><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="10" height="1"></td>')
						}
						if (! USE_NEWBODYOPTION) {
							document.write('<td><INPUT TYPE=HIDDEN name="bodytitle" value="]]><PROCESS>bodytitle</PROCESS><![CDATA["></td>');						
						}
						if (USE_BODYSELECTOR && USE_NEWBODYOPTION) {
							document.write('<td>]]><INPUTFIELD name="bodytitle" class="textfeld" size="8" length="255" method="setBodyTitle"/><![CDATA[</td>');
							document.write('<td><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="5" height="1"></td>');
							document.write('<td width="26" align="center" class="tbl"><a href="javascript:doTemplSubmit(6);" onMouseOver="bu06.className=\'over\';" onMouseOut="bu06.className=\'norm\';" onClick="bu06.className=\'push\';"><img name="bu06" src="]]><METHOD name="resourcesUri">bu_newbody.gif</METHOD><![CDATA[" width="20" height="20" alt="]]><LABEL value="button.newbody"/><![CDATA["></td>');
						}
						</script>
						<td width="20" align="left"><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="20" height="28"></td>
						<td width="100%" align="right" class="tbl"><a href="#" onMouseOver="bu05.className='over';" onMouseOut="bu05.className='norm';" onMouseDown="bu05.className='push';doTemplSubmit(5);"><img name="bu05" src="]]><METHOD name="resourcesUri">bu_preview.gif</METHOD><![CDATA[" width="20" height="20" alt="]]><LABEL value="button.preview"/><![CDATA["><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="5" height="1"></td>
					</tr>
				</table></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td height="4" width="100%" background="]]><METHOD name="resourcesUri">bu_sep_horizontal.gif</METHOD><![CDATA["><img src="]]><METHOD name="resourcesUri">empty.gif</METHOD><![CDATA[" width="1" height="4"></td>
	</tr>
	<tr>
		<td>]]><ELEMENT name="editor"/><![CDATA[
<INPUT TYPE=HIDDEN NAME="content">
<INPUT TYPE=HIDDEN NAME="action">
<INPUT TYPE=HIDDEN NAME="file" value="]]><PROCESS>file</PROCESS><![CDATA[">
</form>
<form name=PREVIEW id=PREVIEW TARGET="PREVIEW" METHOD=POST>
<INPUT TYPE=HIDDEN name="bodyclass">
<INPUT TYPE=HIDDEN name="bodyfile">
<INPUT TYPE=HIDDEN name="title">
<INPUT TYPE=HIDDEN name="action">
<INPUT TYPE=HIDDEN name="body">
<INPUT TYPE=HIDDEN name="bodytitle">
<INPUT TYPE=HIDDEN name="template">
<INPUT TYPE=HIDDEN name="editor">
<INPUT TYPE=HIDDEN NAME="content">
<INPUT TYPE=HIDDEN NAME="file">
</form>
</table>
</body>
</html>
]]>
</template>

<TEMPLATE name="parseerror">
<![CDATA[
]]><ERRORPAGE title="error.title.login" message="error.message.login" reason="error.reason.login" suggestion="error.suggestion.login" ref="templateeditor.html"  ><process>details</process></ERRORPAGE><![CDATA[
]]>
</TEMPLATE>

<TEMPLATE name="errorsave">
<ERRORPAGE title="error.title.editorsave" message="error.message.editorsave" reason="error.reason.editorsave" suggestion="error.suggestion.editorsave" ref="edit_page_main.html" ><process>errordetail</process></ERRORPAGE>
</TEMPLATE>

<ELEMENTDEF name="edit_options">
	<CLASS>com.opencms.template.CmsXmlTemplate</CLASS>
	<TEMPLATE>/system/workplace/templates/edit_options</TEMPLATE>
</ELEMENTDEF>

<HELP_DISABLED />
<HELP_ENABLED />

</workplace>