<?xml version="1.0" encoding="ISO-8859-1"?>
<workplace>
<template>
<![CDATA[
<html>
<head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=]]><METHOD name="getCharset" /><![CDATA[">
<title>]]><LABEL value="label.wptitle" /><![CDATA[ ]]><METHOD name="userName" /><![CDATA[</title>
<link rel=stylesheet type="text/css" href="../css/format.css">
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="../templates/js/opencms.js"></SCRIPT>
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript">   
    
    ]]><ELEMENT name="edit_options"/><![CDATA[

    // which button is clicked
    function doTemplSubmit(para)
    {
        document.EDITOR.action.value = "";
        switch (para)
        {
        case 1:
            doSubmit();
            document.EDITOR.submit();
            break;
        case 2:
            alert("NYI!");
            break;
        case 3:
            doSubmit();
            document.EDITOR.submit();
            break;
        case 4:
            // new template selected
            doSubmit();
            document.EDITOR.submit();
            break;
        case 5:
            // preview selected
            doSubmit();
            document.PREVIEW.bodyclass.value = document.EDITOR.bodyclass.value;
            document.PREVIEW.bodyfile.value = document.EDITOR.bodyfile.value;
            document.PREVIEW.title.value = document.EDITOR.title.value;
            document.PREVIEW.body.value = document.EDITOR.body.options[document.EDITOR.body.selectedIndex].value;
            document.PREVIEW.bodytitle.value = document.EDITOR.bodytitle.value;
            document.PREVIEW.template.value = document.EDITOR.template.options[document.EDITOR.template.selectedIndex].value;
            document.PREVIEW.editor.value = document.EDITOR.editor.options[document.EDITOR.editor.selectedIndex].value;
            document.PREVIEW.content.value = document.EDITOR.content.value;
            document.PREVIEW.file.value = document.EDITOR.file.value;
            document.PREVIEW.action.value = "preview";
            document.PREVIEW.submit();
            break;
        case 6:
            // New Body;
            doSubmit();
            document.EDITOR.action.value = "newbody";
            document.EDITOR.submit();
            break;
        }
    }
    
    <!-- Sets the Document Source-Code for later including into the editor -->
    var text="]]><METHOD name="setText"/><![CDATA[";

    <!-- URL for pictures -->
    var pfad="]]><METHOD name="picsUrl"/><![CDATA[";
    
    <!-- Filename -->
    var filename="]]><PROCESS>file</PROCESS><![CDATA[";
    
    <!-- Needed space for additional toolbar -->
    var space=75;

    var NS = null;
    var IE = null;
    
    NS = (document.layers)? true:false;
    IE = (document.all)? true:false;
    
    var LANG_CUT = "]]><LABEL value="editor.context.cut"/><![CDATA[";
    var LANG_COPY = "]]><LABEL value="editor.context.copy"/><![CDATA[";
    var LANG_PASTE = "]]><LABEL value="editor.context.paste"/><![CDATA[";
    var LANG_INSERTROW = "]]><LABEL value="editor.context.insertrow"/><![CDATA[";
    var LANG_DELETEROW = "]]><LABEL value="editor.context.deleterow"/><![CDATA[";
    var LANG_INSERTCOL = "]]><LABEL value="editor.context.insertcol"/><![CDATA[";
    var LANG_DELETECOL = "]]><LABEL value="editor.context.deletecol"/><![CDATA[";
    var LANG_INSERTCELL = "]]><LABEL value="editor.context.insertcell"/><![CDATA[";
    var LANG_DELETECELL = "]]><LABEL value="editor.context.deletecell"/><![CDATA[";
    var LANG_MERGECELL = "]]><LABEL value="editor.context.mergecell"/><![CDATA[";
    var LANG_SPLITCELL = "]]><LABEL value="editor.context.splitcell"/><![CDATA[";
</SCRIPT>

<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript" SRC="../templates/js/opencms_]]><PROCESS>editor</PROCESS><![CDATA[.js"></SCRIPT>

<!-- Update the Font display on change -->
<SCRIPT LANGUAGE="javascript" FOR="EDIT_HTML" EVENT="DisplayChanged">
<!--
    function displayChangedHandle()
    {
    if (IE==true) return DisplayChanged();
    }
    displayChangedHandle();
    //-->
</script>

<!-- Show a context menu if the right mousebutton is clicked -->
<script LANGUAGE="javascript" FOR="EDIT_HTML" EVENT="ShowContextMenu">
<!--
    function showContextMenuHandle()
    {
    if (IE==true) return ShowContextMenu();
    }
    showContextMenuHandle();
//-->
</script>

<!-- Invoke a context menu action -->
<script LANGUAGE="javascript" FOR="EDIT_HTML" EVENT="ContextMenuAction(itemIndex)">
<!--
    function contextMenuActionHandle()
    {
    if (IE==true) return ContextMenuAction(itemIndex);
    }
    contextMenuActionHandle();
//-->
</script>

<script LANGUAGE="vbscript">
Sub getStyles()
    ' Create the block fmt names holder
    Set fmt = CreateObject("DEGetBlockFmtNamesParam.DEGetBlockFmtNamesParam.1")

    ' Get the localized strings for the DECMD_SETBLOCKFMT command
    EDITOR.EDIT_HTML.ExecCommand DECMD_GETBLOCKFMTNAMES, OLECMDEXECOPT_DONTPROMPTUSER, fmt

    ' Put the localized strings into a (JavaScript) array
    i = 0
    For Each fmtName In fmt.Names
        setStyles i, fmtName
        i = i + 1
    Next
End Sub
</script>

</head>

<body background="]]><METHOD name="picsUrl">bg_grau.gif</METHOD><![CDATA[" bgproperties=fixed scroll=no onLoad="setText();initStyles();" marginwidth=5 marginheight=5 leftmargin=5 topmargin=5>

<table cellspacing=0 cellpadding=0 border=0 width="100%" height="100%"> <tr> <td valign="top">
<form name=EDITOR id=EDITOR METHOD=POST>
    <INPUT TYPE=HIDDEN name="bodyclass" value="]]><PROCESS>bodyclass</PROCESS><![CDATA[">
    <INPUT TYPE=HIDDEN name="bodyfile" value="]]><PROCESS>bodyfile</PROCESS><![CDATA[">
    <INPUT TYPE=HIDDEN name="URL" id="URL">
        <table width=100%>
            <tr>
                <td class=dialogtxt>]]><LABEL value="input.title"/>:<![CDATA[&nbsp;&nbsp;&nbsp;]]> <INPUTFIELD name="title" class="textfeld" size="10" length="255" method="setTitle"/><![CDATA[</td>
                <td class=dialogtxt>]]><LABEL value="input.editor"/>:<![CDATA[&nbsp;&nbsp;&nbsp;]]><SELECT class="textfeld" name="editor" width="200" method="getEditorViews" onchange="doTemplSubmit(3);"/><![CDATA[</td>

                <script language="JavaScript">                  
                if (USE_TEMPLATESELECTOR && (! USE_BODYSELECTOR)) {            
                    document.write('<td class=dialogtxt><p class=tab>]]><LABEL value="input.template"/>:<![CDATA[&nbsp;&nbsp;&nbsp;</td>');
                    document.write('<td class=dialogtxt>]]><SELECT class="textfeld" name="template" width="220" method="getAvailableTemplates" onchange="doTemplSubmit(4);"/><![CDATA[</td>');
                } else if (! USE_TEMPLATESELECTOR) {
                    document.write('<td style="visibility:hidden;">]]><SELECT class="textfeld" name="template" width="1" method="getAvailableTemplates" /><![CDATA[</td>');
                }
                if (! USE_BODYSELECTOR) {
                    document.write('<td style="visibility:hidden;">]]><SELECT class="textfeld" name="body" width="1" method="getBodys" /><![CDATA[</td>');
                    document.write('<td><INPUT TYPE=HIDDEN name="bodytitle"></td>');
                }
                </script>

                <td class=menu align=right width="100%">]]><BUTTON href="#" name="bt_docpreview" action="javascript:doTemplSubmit(5);" alt="preview"/><![CDATA[</td>
                
                <script language="JavaScript">                  
                if (USE_BODYSELECTOR && USE_TEMPLATESELECTOR) {            
                    document.write('</tr></table></td></tr><tr><td><hr></td></tr><tr><td><table><tr>');
                }
                </script>
        
                ]]><!-- FLEX: Removed static body select entries and replaced them with dynamic entries:    
                <td class=menu><p class=tab>]]><BUTTON href="javascript:doTemplSubmit(6);" name="bt_newdoc" action="" alt="newbody"/><![CDATA[</td>
                --><![CDATA[
                                    
                <script language="JavaScript">                  
                if (USE_BODYSELECTOR) {
                    document.write('<td class=menubold>]]><LABEL value="input.body"/>:<![CDATA[&nbsp;&nbsp;&nbsp;</td>');
                    document.write('<td class=dialogtxt>]]><SELECT class="textfeld" name="body" width="80" method="getBodys" onchange="doTemplSubmit(1);"/><![CDATA[</td>');
                    document.write('<td class=dialogtxt>]]><INPUTFIELD name="bodytitle" class="textfeld" size="10" length="255" method="setBodyTitle"/><![CDATA[</td>');
                    document.write('<td class=menu><p class=tab><A href="javascript:doTemplSubmit(6);" onmousedown="ChPush(\'bt_newdoc\');" onmouseout="ChOff(\'bt_newdoc\')" onmouseover="ChOn(\'bt_newdoc\')" onmouseup="ChOn(\'bt_newdoc\')"><IMG alt="]]><LABEL value="button.newbody"/><![CDATA[" width=32 border=0 name=bt_newdoc src="/opencms/pics/system/bt_newdoc_off.gif" ></a></td>');
                }        
                if (USE_TEMPLATESELECTOR && USE_BODYSELECTOR) {            
                    document.write('<td class=menubold><p class=tab>]]><LABEL value="input.template"/>:<![CDATA[&nbsp;&nbsp;&nbsp;</td>');
                    document.write('<td class=dialogtxt>]]><SELECT class="textfeld" name="template" width="220" method="getAvailableTemplates" onchange="doTemplSubmit(4);"/><![CDATA[</td>');
                    document.write('<td class=menu width="100%" align=right>&nbsp;</td>');
                }
                </script>
                                                           
            </tr>
        </table>
</td></tr>
<tr><td><hr></td></tr>
<tr><td>

  ]]><ELEMENT name="editor"/><![CDATA[
    <INPUT TYPE=HIDDEN NAME="content">
    <INPUT TYPE=HIDDEN NAME="action">   
    <INPUT TYPE=HIDDEN NAME="file" value="]]><PROCESS>file</PROCESS><![CDATA[">             
</form>
<form 
    name=PREVIEW 
    id=PREVIEW
    TARGET="PREVIEW"
    METHOD=POST>
    <INPUT TYPE=HIDDEN name="bodyclass">
    <INPUT TYPE=HIDDEN name="bodyfile">
    <INPUT TYPE=HIDDEN name="title">
    <INPUT TYPE=HIDDEN name="action">
    <INPUT TYPE=HIDDEN name="body">
    <INPUT TYPE=HIDDEN name="bodytitle">
    <INPUT TYPE=HIDDEN name="template">
    <INPUT TYPE=HIDDEN name="editor">
    <INPUT TYPE=HIDDEN NAME="content">
    <INPUT TYPE=HIDDEN NAME="file">     
</form>
</td></tr>
</table>
</body>
</html>
]]>
</template>

<TEMPLATE name="parseerror">
<![CDATA[
]]><ERRORPAGE title="error.title.login" message="error.message.login" reason="error.reason.login" suggestion="error.suggestion.login" ref="templateeditor.html"  ><process>details</process></ERRORPAGE><![CDATA[
]]>
</TEMPLATE>

<TEMPLATE name="errorsave">
<ERRORPAGE title="error.title.editorsave" message="error.message.editorsave" reason="error.reason.editorsave" suggestion="error.suggestion.editorsave" ref="edit_page_main.html" ><process>errordetail</process></ERRORPAGE>
</TEMPLATE>

<ELEMENTDEF name="edit_options">
    <CLASS>com.opencms.template.CmsXmlTemplate</CLASS>
    <TEMPLATE>/system/workplace/templates/edit_options</TEMPLATE>
</ELEMENTDEF> 

</workplace>
