<%@ page import="org.opencms.workplace.*" buffer="none" %><%
	
	// get workplace class from request attribute
	CmsDialog wp = CmsDialog.initCmsDialog(pageContext, request, response);
    wp.setParamAction(wp.DIALOG_CONFIRMED);

%><%= wp.htmlStart() %>

<script type="text/javascript">
var init = false;

function toggleElement(id) {
	var element = document.getElementById(id);
	var cl = element.className;
	if (cl == "hide") {
		element.className = "show";
		if (! init) {
			init = true;
			setTimeout("initTrace()", 0);
		}
	} else {
		element.className = "hide";
	}
}

function initTrace() {
	trace.document.open();
	trace.document.write("<%= wp.getFormattedErrorstack() %>");
	trace.document.close();
}
</script>

<%= wp.bodyStart("dialog") %>

<%= wp.dialogStart() %>
<%= wp.dialogContentStart(wp.getParamTitle()) %>

<table border="0" cellpadding="4" cellspacing="0">
<tr>
	<td style="vertical-align: middle;"><img src="<%= wp.getSkinUri() %>explorer/error.gif" border="0"></td>
	<td style="vertical-align: middle;"><%= wp.getParamMessage() %></td>
</tr>
</table>

<%= wp.dialogBlockStart(wp.key("message.reason")) %>

<%= wp.getParamReasonSuggestion() %>

<%= wp.dialogBlockEnd() %>
<%= wp.dialogSpacer() %>

<%= wp.dialogSpacer() %>

<%= wp.dialogContentEnd() %>

<form name="close" action="" class="nomargin">
<%
	if (wp.getParamErrorstack() == null || "".equals(wp.getParamErrorstack())) {
%>
<%= wp.dialogButtonRowClose() %>
<%	} else { %>
<%= wp.dialogButtonRowCloseDetails(null, "onClick=\"toggleElement('errorStack');\"") %>
<%	} %>
</form>

<div id="errorStack" class="hide">
<div style="margin: 10px; ">
<iframe name="trace" id="trace" src="about:blank" style="width:100%; height:400px; margin: 0; padding: 0;"></iframe>
</div>
</div>

<%= wp.dialogEnd() %>
<%= wp.bodyEnd() %>
<%= wp.htmlEnd() %>