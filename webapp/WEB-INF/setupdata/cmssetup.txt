# Turn echo on
echo on

# Login the Admin user
login "Admin" "admin"

# Create the setup project
createTempfileProject

# Switch to the setup project
setCurrentProject "_setupProject"

# Initialize the default property definitions
createPropertyDefinition Title
createPropertyDefinition Description
createPropertyDefinition Keywords
createPropertyDefinition NavText
createPropertyDefinition NavPos
createPropertyDefinition export
createPropertyDefinition exportname
createPropertyDefinition default-file
createPropertyDefinition content-encoding
createPropertyDefinition content-conversion
createPropertyDefinition internal
createPropertyDefinition cache
createPropertyDefinition template
createPropertyDefinition template-elements
createPropertyDefinition locale

# Switch to the root context
setSiteRoot "/"

# Create folder structure
createFolder "/" "sites/"
createFolder "/sites/" "default/"

# Apply folder permissions
chacc "/" "group" "Administrators" "+v+w+r+c+d+i"
chacc "/" "group" "Projectmanagers" "+v+w+r+c+d+i"
chacc "/" "group" "Users" "+v+w+r+i"
chacc "/" "group" "Guests" "+v+r+i"
chacc "/system/orgunits" "group" "Users" "-v"

# Publish the project
unlockCurrentProject
publishProjectAndWait

# Create the default "Offline" project
createDefaultProject "Offline" "The Offline Project"
setSiteRoot "/sites/default/"

# Import the modules that have been selected in the setup wizard
importModulesFromSetupBean

exit
