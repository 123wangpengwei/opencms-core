# Turn echo on
echo on

# Login the Admin user
login Admin admin

# Create the setup project
createTempfileProject

# Switch to the setup project
setCurrentProject "_setupProject"

# Initialize the default property definitions
createPropertydefinition Title
createPropertydefinition Description
createPropertydefinition Keywords
createPropertydefinition NavText
createPropertydefinition NavPos
createPropertydefinition export
createPropertydefinition exportname
createPropertydefinition default-file
createPropertydefinition content-encoding
createPropertydefinition internal
createPropertydefinition cache
createPropertydefinition stream
createPropertydefinition template
createPropertydefinition template-elements
createPropertydefinition locale

# Switch to the root context
setSiteRoot "/"

# Create folder structure
createFolder "/" "system/"
createFolder "/" "sites/"
createFolder "/" "channels/"
createFolder "/sites/" "default/"

# Apply folder permissions
chacc "/" "group" "Administrators" "+v+w+r+c+d+i"
chacc "/" "group" "Projectmanagers" "+v+w+r+c+d+i"
chacc "/" "group" "Users" "+v+w+r+c+i"
chacc "/" "group" "Guests" "+v+r+i"

# Import the workplace
importResources "setupdata/vfs" "/"

# Publish the project
unlockCurrentProject
publishProject

# Create the default "Offline" project
createDefaultProject "Offline" "The Offline Project"
setSiteRoot "/sites/default/"

# Import the modules that have been selected in the setup wizard
importModulesFromSetupBean

# Build search indexes
updateIndex

exit
