<?xml version="1.0" encoding="ISO-8859-1"?>
<xmltemplate>
<template> 
<html>
<head>
<title>Modul für das Suchformular</title>
</head>
<body bgcolor="#C0C0C0">

<h1 align="center"><font color="blue">Aktionsmodul (Actionmodul)</font></h1> 
<h2><u>Allgemein:</u></h2>
<p align="justify">
Dieses Modul ist die Schnittstelle zwischen OpenCms und den vorhandenen Suchmaschinen (im Moment gibt es nur Ht://Dig). Es beinhaltet das Formular für die Sucheingaben und die zugehörigen Klassen. Die Selectboxen, welche die Parameter für die Suche enthalten, werden zum Teil dynamisch durch die angesprochene Suchmaschine gefüllt. Für den Fall, dass die Selectboxen nicht benötigt werden, kann man diese auch löschen. Es werden dann automatisch die Standardwerte für die Parameter genommen.
</p>
<p align="justify">
Das Suchformular orientiert sich stark an die Suchmaschine Ht://Dig, da diese eine breite Vielfalt an Konfigurationsmöglichkeiten besitzt. Bei anderen Suchmaschinen kann es vorkommen das nicht alle Funktionen des Suchformulars ausgenutzt werden. Darauf wird in der Beschreibung der Moduleigenschaften (der Suchmaschinen) hingewiesen.
</p>
<p align="justify">
Das Template für das Suchformular (searchengineForm) ist in der Demoseite als ELEMENT eingebunden und liegt im Verzeichnis <b>/system/modules/com.opencms.modules.search.form/internal/</b>. Folgende Operationen sind möglich:
</p>
<ul type="disc">
<li>Method</li>
<li>Format</li>
<li>Sort</li>
<li>Restriction</li>
</ul>

<h3>Method</h3>
Auswahl der logischen Verknüpfung für die Suche. Die Suchbegriffe werden nach der Eingabe mit der jeweiligen Option verknüpft. Für Htdig sind dies:
<ul type="cycle">
<li>All - logische UND Verknüpfung (AND)</li>
<li>Any - logische ODER Verknüpfung (OR)</li>
<li>Boolean - für BOOLSCHE Verknüpfung</li>
</ul>
<p align="justify">
Werden im Eingabefeld zum Beispiel die beiden Begriffe "Opencms java" eingegeben und die Methode All (UND) als Verknüpfung gewählt, so werden die beiden Begriffe logisch mit UND verknüpft. Als Treffer werden nur die Webseiten angezeigt die beide Begriffe enthalten. Bei der Methode Any (ODER) würden in diesem Fall alle Webseiten angezeigt, die entweder den Begriff Opencms oder den Begriff java enthalten.
</p>
<p align="justify">
Anders sieht es bei der boolschen Verknüpfung aus, hier müssen explizit die Operatoren angegeben werden. Die Suchbegriffe werden dann mit diesen Operatoren verknüpft, z.B.: "((<b>opencms</b> OR <b>java</b>) AND <b>welcome</b>) NOT <b>author</b>". Dies ist schon eine ziemlich komplexe Suchanfrage, die kurz erläutert werden soll.
</p>
<p align="justify">
Als erstes wird die innere Klammer ausgewertet, d.h. alle Bereiche, in denen <b>opencms</b> oder <b>java</b> enthalten sind. Danach folgt die AND Verknüpfung mit <b>welcome</b>, wodurch im Bereich <b>opencms</b> oder <b>java</b> nun der Suchbegriff <b>welcome</b> auftreten muss. Als letzte Einschränkung der Suche folgt der NOT Operator, der das nachfolgende Wort ausschließt, damit darf in dem nun aufgestellt Suchbereich das Wort <b>author</b> nicht vorkommen. Fehlen bei der boolschen Verknüpfung die Operatoren, so wird die Fehlermeldung syntax error ausgegeben.
</p>

<h3>Format</h3>
<p align="justify">
Über die Selectbox Format wird die Art der Ausgabe bestimmt. Es gibt die Option Long, für eine ausführliche Ausgabe, und die Option Short, für eine kurze gehaltene Ausgabe.
</p>

<h3>Sort</h3>
Über Sort wird die Sortierung der Treffer für die Ausgabe ausgewählt.
<ul type="cycle">
<li>Score: Sortierung nach den meisten Treffern.</li>
<li>Date: Sortierung nach aktuellen Datum.</li>
<li>Title: Alphabetische Sortierung der Title.</li>
</ul>
Die Sortierung kann auch in umgekehrter (Reverse) Reihenfolge vorgenommen werden.

<h3>Restriction</h3>
Unter diesem Punkt kann ausgewählt werden, in welchen, Bereich der Webseite gesucht werden soll.
<hr noshade>

<h2><U>Layout:</U></h2>
<p align="justify">
Das Layout bezieht sich auf das Template <b>searchengineForm</b>, welches in dem oben angegebenen Pfad liegt. Dieses Template kann in jeder beliebigen Seite als ELEMENT eingebunden werden.<br> Das Template <b>searchengineForm</b> besteht aus einem Suchformular (<i>Template TAG</i>), welches die Eingabe entgegen nimmt, und einer Ausgabeseite (<i>Template name="result" TAG</i>) für das Suchergebnis. Die Datenblöcke werden im Abschnitt Anbindungen besprochen.
</p>

<h3>Suchformular (standard Template)</h3>
<p align="justify">
Wie schon erwähnt, sind die Selectboxen optional und können nach Bedarf auch gelöscht werden. Ansonsten kann das Layout der Seite ohne weiteres angepasst werden. Der process Tag message ist für die Fehlerausgabe verantwortlich, alle auftretenden Fehler werden durch diesen angezeigt (siehe Abschnitt Fehlermeldungen).
</p>

<h3>Ausgabeseite (result Template)</h3>
<p align="justify">
Für die Ergebnisausgabe wird in den Bereich <i>Template name="Result"</i> gewechselt. Die Ausgabeseite besteht aus einem Informationsbereich, einer Navigation und einem Ergebnisbereich.
</p>

<h4>Informationsbereich</h4>
Der Informationsbereich besteht aus folgenden process Tags:
<ul type="disc">
<li>searchword: 	Hier wird das eingegebene Suchwort eingefügt</li>
<li>pages:	Gesamte Anzahl der Seiten</li>
<li>currentpage: Aktuelle Seite</li>
<li>first:	Erste Treffer der Seite</li>
<li>last:	Letzte Treffer der Seite</li>
<li>match:	Gesamte Treffer</li>
</ul>

<h4>Navigation</h4>
<p align="justify">
Mit dem process Tag <i>navigation</i> wird die Navigation aufgebaut. Dazu werden die Datenblöcke <i>nav</i> und <i>currentnav</i> verwendet. Im Datenblock <i>nav</i> wird die URL, mit dem Query-String der Suchanfrage, an die Seitenzahl gehängt. Der Datenblock <i>currentnav</i> gibt die aktuelle Seite aus, wobei keine Url angehängen wird.
</p>
Der process Tag <i>numberurl</i> generiert die Seitenzahlen entsprechend der Treffer.

<h4>Ergebnisbereich</h4>
<p align="justify">
Der Ergebnisbereich ist abhängig von der Option, die in der Selectbox <b>format</b> ausgewählt wurde. Bei der Option Short wird der Datenblock <i>shortrow</i> ausgegeben. Wird die Option Long ausgewählt so wird der Datenblock <i>longrow</i> angezeigt. Sollte die Selectbox nicht vorhanden sein, wird als Standard der Datenblock <i>longrow</i> ausgegeben. Für den Aufbau von <i>longrow</i> und <i>shortrow</i> werden folgende process Tags verwendet:
</p>
<ul type="disc">
<li>number:	Erzeugung einer laufenden Nummer.</li>
<li>url:	Angabe der Url.</li>
<li>title:	Angabe des Titels der Html Seite.</li>
<li>excerpt:	Kleiner Textauszug von der Html Seite. Im Fall von Ht://Dig kann die Größe des Textauszugs in der Konfigurationsdatei (htdig.conf) eingestellt werden.</li>
<li>percent:	Trefferquote der Seite in Prozent.</li>
<li>size:	Größe der Html Seite.</li>
</ul>
<hr noshade>

<h2><u>Anbindung:</u></h2>
<p>Es gibt drei Tags, die wichtig für die Anbindung an ein Suchmaschinen Modul sind.</p>
<ul type="disc">
<li>contentDefinition</li>
<li>configurationFile</li>
<li>matchesperpage</li>
</ul>
<p align="justify">
Der Datenblock <i>contentDefinition</i> gibt die Klasse an, die auf die Suchmaschine zugreift. Als Standard wird die Suchmaschine Ht://Dig angezeigt, da diese im Moment die einzige ist. Die Klasse, die auf diese Suchmaschine zugreift, heißt <b>CmsHtdig</b> und liegt im Paket <b>com.opencms.modules.search.htdig</b>, also lautet der Eintrag in dem <i>contentDefinition</i> Datenblock: <b>com.opencms.modules.search.htdig.CmsHtdig</b>. Dies ist, wie schon erwähnt, die Standardeinstellung, die immer angezeigt wird, wenn man dieses Modul hochlädt. Soll nun ein anderes Suchmodul eingebunden werden, muss im <i>contentDefinition</i> Datenblock der Paketname und die Klasse eingetragen werden. Der Paketname sowie die benötigte Klasse stehen in den Moduleigenschaften der gewünschten Suchmaschine.
</p>
<p align="justify">
Der Datenblock <i>configurationFile</i> gibt die aktuelle Konfigurationsdatei an, die für die Suche genommen werden soll. Dieser Datenblock wird im Moment nur von Ht://Dig unterstützt. Es wird nur der Dateiname und nicht die Dateiendung benötigt. Soll zum Beispiel die Konfigurationsdatei tester.configurationFile verwendet werden, so lautet der Eintrag im <i>Datenblock</i> configurationFile tester (ohne Dateiendung).
</p>
<p align="justify">
Der Datenblock <i>matchesperpage</i> gibt die Anzahl der Treffer an, die auf einer Seite angezeigt werden soll. Standard sind 10 Treffer pro Seite.
</p>
<p align="justify">
Des weiteren gibt es noch zwei Datenblöcke mit denen man den Suchbereich auf der Webseite eingrenzen kann. Die Datenblöcke lauten <i>areaRestrict</i>, für Verwendung der Selectbox <b>restrict</b>, und <i>singleRestriction</i> zum Festlegen eines einzigen Suchbereiches. Für den Fall, dass nichts in beiden Datenblöcken steht wird automatisch die gesamte Website als Suchbereich genommen. Es sollte immer nur einer von beiden Datenblöcke verwendet werden. Wenn in beiden Datenblöcken Angaben gemacht worden sind, wird nur die Angabe im Datenblock <i>singleRestriction</i> für die Suche berücksichtigt. Wird der Datenblock <i>areaRestrict</i> nicht verwendet, so kann die Selectbox <b>restrict</b> gelöscht werden.
</p>
<p align="justify">
Der Suchbereich stellt die Ordner da, in denen die Webseiten liegen. Sollen z.B. nur die Webseiten im Ordner Projekte durchsucht werden, so wird im Datenblock <i>singleRestriction</i> <b>/Projecte/</b> eingetragen. Nach dem Veröffentlichen wird die Suchmaschine nur in diesem Bereich suchen.<br> Aus dem Datenblock <i>areaRestrict</i> holt die Selectbox <b>restrict</b> sich die Werte, deshalb ist bei Eintragungen in diesen Datenblock folgendes zu beachten:
</p>
<ul type="disc">
<li>jeder Eintrag wird durch ein Komma getrennt.</li>
<li>zwei Einträge gehören zu einer Option in der Selectbox, der erste Eintrag ist der Wert der zweite der zugehörige Name (z.B.: &ltarea_restrict&gt/Project/,Projekte&lt/area_restrict&gt</li>
<li>soll die Möglichkeit bestehen die gesamte Webseite zu durchsuchen so muss restricttoall als Wert eingetragen werden, der zugehörige Name kann beliebig sein.</li>
</ul>
Beispiel:<br>
&ltareaRestrict&gtrestricttoall,All,/history/,Companies history&lt/areaRestrict&gt<br>
&ltsingleRestriction&gt&lt/singleRestriction&gt<br>
<p align="justify">
Bei dem Datenblock <i>singleRestriction</i> muss nur der Bereich (Ordner) angegeben werden und nicht der Name. Wenn die gesamte Website durchsucht werden soll, wird in beide Datenblöcke nichts eingetragen.
</p>
Beispiel<br>
Nur der Bereich Project wird durchsucht<br>
&ltareaRestrict&gt&lt/areaRestrict&gt<br>
&ltsingleRestriction&gt/Project/&lt/singleRestriction&gt<br><br>
Die gesamte Website wird durchsucht<br>
&ltareaRestrict&gt&lt/areaRestrict&gt<br>
&ltsingleRestriction&gt&lt/singleRestriction&gt<br><br><br>

<hr noshade>
<h2><u>Fehlermeldungen:</u></h2>
<p align="justify">
Das Suchformular besitzt fünf Fehlermeldungen, die in dem Bereich <i>Error message</i> liegen. Diese Fehlermeldungen kann man beliebig verändern, wichtig ist, dass man den <i>message</i> Tag im Template selbst nicht löscht, da dieser für die Fehlerausgaben verantwortlich ist.Es gibt folgende Fehlermeldungen:
</p>
<ul type="disc">
<li>Content Definition not found</li>
<li>Serverpath not found</li>
<li>Please insert a search word</li>
<li>No match</li>
<li>Syntax Error</li>
</ul>
<h4>- Content Definition not found</h4>
Dieser Fehler wird entweder durch einen falschen Namen im Tag <i>contentDefinition</i> ausgelöst oder das entsprechende Modul ist nicht vorhanden.
<h4>- Serverpath not found</h4>
Ist der Parameter in den Moduleigenschaften (der Suchmaschine !!) falsch, wird diese Fehlermeldung ausgegeben.
<h4>- Please insert a search word</h4>
Wird in das Suchfeld des Formulars nichts eingetragen, wird der Anwender aufgefordert, einen Suchbegriff einzugeben.
<h4>- No match</h4>
Die Suche war ergebnislos.
<h4>- Syntax Error</h4>
Dieser Fehler wird dadurch hervorgerufen, dass bei einer boolean Suche keine Operatoren angegeben werden. Operatoren sind AND, OR, NOT.
<hr noshade>
<h2><u>Voraussetzung:</u></h2>
<ul type="disc">
<li>Hochladen des gewünschten Suchmoduls.</li> 
<li>Angabe des Serverpfades, welchen die Suchmaschine benötigt. Diese Angabe wird in den Moduleigenschaften festgelegt.</li>
<li>Weitere Informationen über die Installation und Konfiguration der Suchmaschine befinden sich im doc - Verzeichnis des Suchmoduls.</li>
</ul>   
</body>
</html>
</template>
</xmltemplate>